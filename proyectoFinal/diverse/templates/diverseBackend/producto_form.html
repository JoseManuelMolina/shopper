{% extends 'diverseBackend/baseBackend.html' %}
{% block content %}
    <div class="row">
        <div class="col-md-12">
            <h3>Crear Producto</h3>

            <form method="POST" id="productoForm" data-modelos-url="{% url 'ajax_load_modelos' %}" data-subcategoria-url="{% url 'ajax_load_subcategorias' %}">
                {% csrf_token %}

                    <div class="form-group col-md-10">
                        {{ form.num_ref }}
                        </br>
                        <label for="{{ form.precio.label }}">{{ form.precio.label }}</label></br>
                        {{ form.precio }}
                        </br>
                        <label for="{{ form.imagen.label }}">{{ form.imagen.label }}</label></br>
                        {{ form.imagen }}
                        </br>
                        <label for="{{ form.sexo_id.label }}">{{ form.sexo_id.label }}</label></br>
                        {{ form.sexo_id }}
                        </br></br>
                        <label for="{{ form.categoria_id.label }}">{{ form.categoria_id.label }}</label></br>
                        {{ form.categoria_id }}
                        </br></br> 
                        <label for="{{ form.subCategoria_id.label }}">{{ form.subCategoria_id.label }}</label></br>
                        {{ form.subCategoria_id }}
                        </br></br> 
                        <label for="{{ form.marca_id.label }}">{{ form.marca_id.label }}</label></br>
                        {{ form.marca_id }}
                        </br></br>
                        <label for="{{ form.modelo_id.label }}">{{ form.modelo_id.label }}</label></br>
                        {{ form.modelo_id }}
                        </br></br>
                        <label for="{{ form.color_id.label }}">{{ form.color_id.label }}</label></br>
                        {{ form.color_id }}
                        </br></br>
                        <label for="{{ form.talla_id.label }}">{{ form.talla_id.label }}</label></br>
                        {{ form.talla_id }}
                        </br>
                    </div>

                <button type="submit" class="btn btn-primary">Crear</button>
            </form>
        </div>
    </div>
{% endblock content %}

{% block scriptsfooter %}
    <script>
        $('#marcaProducto').change(function(){
            const url = $("#productoForm").attr("data-modelos-url");    // Coge la url de la vista "load_modelos"
            const marcaId = $(this).val();                              // Recogemos la ID de la marca seleccionada

            $.ajax({                                                    // Inicializamos la llamada AJAX
                url: url,                                               // Seteamos la url de la llamada (= /diverse/ajax/load-modelos)
                data: {
                    'marca_id': marcaId                                 // Añadimos la id de la marca a los parametros
                },
                success: function (data){                               // 'data' es la respuesta de la funcion 'load_modelo'
                    console.log(data);
                    $('#modeloProducto').html(data);                    // reemplaza los contenido del input de modelos con la informacion que viene desde el servidor
                }
            })
        });

        $('#categoriaProducto').change(function(){
            const url = $("#productoForm").attr("data-subcategoria-url");       // Coge la url de la vista "load_subcategorias"
            const categoriaId = $(this).val();                                  // Recogemos la ID de la categoria seleccionada

            $.ajax({                                                            // Inicializamos la llamada AJAX
                url: url,                                                       // Seteamos la url de la llamada (= /diverse/ajax/load-subcategorias)
                data: {
                    'categoria_id': categoriaId                                 // Añadimos la id de la categoria a los parametros
                },
                success: function (data){                                       // 'data' es la respuesta de la funcion 'load_subcategoria'
                    console.log(data);
                    $('#subcategoriaProducto').html(data);                      // reemplaza los contenido del input de subcategorias con la informacion que viene desde el servidor
                }
            })
        });
    </script>
{% endblock scriptsfooter %}